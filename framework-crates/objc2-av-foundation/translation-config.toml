framework = "AVFoundation"
crate = "objc2-av-foundation"
required-crates = ["objc2", "objc2-foundation"]
custom-lib-rs = true
macos = "10.7"
maccatalyst = "13.1"
ios = "2.2"
tvos = "9.0"
watchos = "3.0"
visionos = "1.0"

external.CIImage.module = "CoreImage.CIImage"
external.CIContext.module = "CoreImage.CIContext"
external.CIBarcodeDescriptor.module = "CoreImage.CIBarcodeDescriptor"

# Only available on iOS
class.AVAsset.methods.preferredDisplayCriteria.skipped = true

# Needs CASpatialAudioExperience, which is not available on macOS (where header-translator runs).
class.AVPlayer.methods.intendedSpatialAudioExperience.skipped = true
class.AVPlayer.methods."setIntendedSpatialAudioExperience:".skipped = true
class.AVSampleBufferRenderSynchronizer.methods.intendedSpatialAudioExperience.skipped = true
class.AVSampleBufferRenderSynchronizer.methods."setIntendedSpatialAudioExperience:".skipped = true

# Unclear error return
protocol.AVAsynchronousKeyValueLoading.methods."statusOfValueForKey:error:".skipped = true
class.AVMetadataItem.methods."statusOfValueForKey:error:".skipped = true

# Counterparts
class.AVAssetDownloadStorageManagementPolicy.counterpart.mutable-subclass = "AVFoundation.AVAssetDownloadStorageManager.AVMutableAssetDownloadStorageManagementPolicy"
class.AVMutableAssetDownloadStorageManagementPolicy.counterpart.immutable-superclass = "AVFoundation.AVAssetDownloadStorageManager.AVAssetDownloadStorageManagementPolicy"
class.AVAudioMix.counterpart.mutable-subclass = "AVFoundation.AVAudioMix.AVMutableAudioMix"
class.AVMutableAudioMix.counterpart.immutable-superclass = "AVFoundation.AVAudioMix.AVAudioMix"
class.AVAudioMixInputParameters.counterpart.mutable-subclass = "AVFoundation.AVAudioMix.AVMutableAudioMixInputParameters"
class.AVMutableAudioMixInputParameters.counterpart.immutable-superclass = "AVFoundation.AVAudioMix.AVAudioMixInputParameters"
class.AVMediaSelection.counterpart.mutable-subclass = "AVFoundation.AVMediaSelection.AVMutableMediaSelection"
class.AVMutableMediaSelection.counterpart.immutable-superclass = "AVFoundation.AVMediaSelection.AVMediaSelection"
class.AVMetadataItem.counterpart.mutable-subclass = "AVFoundation.AVMetadataItem.AVMutableMetadataItem"
class.AVMutableMetadataItem.counterpart.immutable-superclass = "AVFoundation.AVMetadataItem.AVMetadataItem"
class.AVMovie.counterpart.mutable-subclass = "AVFoundation.AVMovie.AVMutableMovie"
class.AVMutableMovie.counterpart.immutable-superclass = "AVFoundation.AVMovie.AVMovie"
class.AVFragmentedMovie.skipped-protocols = ["NSCopying", "NSMutableCopying"] # Unclear what type these return
class.AVTimedMetadataGroup.counterpart.mutable-subclass = "AVFoundation.AVTimedMetadataGroup.AVMutableTimedMetadataGroup"
class.AVMutableTimedMetadataGroup.counterpart.immutable-superclass = "AVFoundation.AVTimedMetadataGroup.AVTimedMetadataGroup"
class.AVDateRangeMetadataGroup.counterpart.mutable-subclass = "AVFoundation.AVTimedMetadataGroup.AVMutableDateRangeMetadataGroup"
class.AVMutableDateRangeMetadataGroup.counterpart.immutable-superclass = "AVFoundation.AVTimedMetadataGroup.AVDateRangeMetadataGroup"
class.AVVideoComposition.counterpart.mutable-subclass = "AVFoundation.AVVideoComposition.AVMutableVideoComposition"
class.AVMutableVideoComposition.counterpart.immutable-superclass = "AVFoundation.AVVideoComposition.AVVideoComposition"
class.AVVideoCompositionInstruction.counterpart.mutable-subclass = "AVFoundation.AVVideoComposition.AVMutableVideoCompositionInstruction"
class.AVMutableVideoCompositionInstruction.counterpart.immutable-superclass = "AVFoundation.AVVideoComposition.AVVideoCompositionInstruction"
class.AVVideoCompositionLayerInstruction.counterpart.mutable-subclass = "AVFoundation.AVVideoComposition.AVMutableVideoCompositionLayerInstruction"
class.AVMutableVideoCompositionLayerInstruction.counterpart.immutable-superclass = "AVFoundation.AVVideoComposition.AVVideoCompositionInstruction"
class.AVCaption.counterpart.mutable-subclass = "AVFoundation.AVCaption.AVMutableCaption"
class.AVMutableCaption.counterpart.immutable-superclass = "AVFoundation.AVCaption.AVCaption"
class.AVCaptionRegion.counterpart.mutable-subclass = "AVFoundation.AVCaption.AVMutableCaptionRegion"
class.AVMutableCaptionRegion.counterpart.immutable-superclass = "AVFoundation.AVCaption.AVCaptionRegion"
class.AVComposition.counterpart.mutable-subclass = "AVFoundation.AVComposition.AVMutableComposition"
class.AVMutableComposition.counterpart.immutable-superclass = "AVFoundation.AVComposition.AVComposition"

# Both protocols and classes
protocol.AVVideoCompositionInstruction.renamed = "AVVideoCompositionInstructionProtocol"

# Property declared twice in MutableEvents
class.AVPlayerInterstitialEvent.categories.MutableEvents.skipped = true

##
## Safety
##

# Breaks type-safety, you must check encodings before accessing a value.
class.NSValue.unsafe = true
